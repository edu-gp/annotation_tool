# References:
- https://medium.com/@sutharprashant199722/how-to-use-alembic-for-your-database-migrations-d3e93cacf9e8
- https://www.compose.com/articles/schema-migrations-with-alembic-python-and
-postgresql/
- https://alembic.sqlalchemy.org/en/latest/

# TL;DR Version (But I strongly recommend reading the first reference)
## Step zero: initialize the migration tool
- `pip install alembic`
- Under the project root: `alembic init alembic`
- Edit `alembic.ini` under project root. Set `sqlalchemy.url =
THE_DATABASE_URL_OF_YOUR_CHOICE`
- Edit `env.py` under `alembic` folder to set `target_metadata =
YOUR_MODEL'S_METADATA_OBJECT`. You may need to add the parent folder of
`alembic` to PYTHONPATH in case you run into `NoModuleFoundError`. See the
line with `sys.path` at the top of `env.py`.

## Step one: Modify the models
Make changes in the `db/model.py` file. All models are currently saved there.

## Step two: Auto-generate the migration script
`alembic revision --autogenerate -m "YOUR_DESCRIPTION_OF_THE_CHANGE"`

## Step three: execute the migration
### Uprade
`alembic upgrade head`. This will update the table to the latest version.

### Downgrade
`alembic downgrade base`. Warning: this will downgrade the table to nothing!

### Choose a specific version
`alembic history` will show all the versions. Pick your favorite and replace
 `head` or `base` with it.

## Note
The autogenerated script has its limitations. For example, the autogenerated
drop command does not work for sqlite. Check the `test_adding_a_fake_field.py`
in the `versions` folder for reference.